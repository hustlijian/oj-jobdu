题目2 : 井字棋
时间限制:10000ms
单点时限:1000ms
内存限制:256MB
描述
小武是井字棋的忠实粉丝，井字棋，又称为井字游戏、井字过三关等，是种纸笔游戏。其具体玩法为：

两个玩家，一个打圈(O)，一个打叉(X)，轮流在3乘3的格上打自己的符号，最先以横、直、斜连成一线则为胜。当9个格子画满，双方均无法取胜时，则为和局。当有玩家取胜或者下成平局后，比赛结束。

1.png

假设每次X方均为先手，给出一个局面，请你判断这个局面是否合法，如果局面合法，则判断当前局面是否是比赛结束局面，如果是，则判断当前局面是X方胜利，O方胜利或者是平局。如果局面暂时未分胜负，则判断下一个下棋的选手下完一步后（假设采用最优策略）能否取胜。

输入
每个输入数据包含多个测试点。

第一行为测试点的个数S <= 2000。之后是S个测试点的数据。

每个测试点的数据包括3行，用于描述整个棋盘。每行包含一个长度为3的字符串，取值范围为{'_', 'O', 'X'}，其中'_'表示该格子为空，'X'表示该格被先手者占领，'O'表示该格被后手者占领。

每个测试点之间会有一个空行相隔。

输出
对于每个测试点，对应的结果输出一行。

如果局面非法，则输出"Invalid"。

否则如果局面是比赛结束局面，X取胜则输出"X win", O取胜则输出"O win", 如果是平局则输出"Draw"。

如果局面合法并且不是比赛结束的局面，则判断下一个下棋的选手下完一步后能否取胜，如果可以，则输出"Next win", 否则输出"Next cannot win"。

注意，所有的结果输出均不带引号。

样例提示
第一个例子，因为X先下，所以该局面不可能出现。

第二个例子，为结束局面，X取胜。

第三个例子，全部格子下完，双方均无法取胜，平局。

第四个例子，局面未分胜负，下一个下的是X，可以取胜。

第五个例子，局面未分胜负，下一个下的是O，无论下到哪一个格子均无法取胜。

样例输入
5
__O
_XO
___

XXX
___
OO_

XXO
OOX
XXO

X_X
OO_
___

XO_
XX_
__O
样例输出
Invalid
X win
Draw
Next win
Next cannot win